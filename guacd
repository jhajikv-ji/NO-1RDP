printf "root\nroot" | sudo passwd root 
sudo apt update
sudo apt install tomcat9 -y
service tomcat9 restart &
/usr/share/tomcat9/bin/daemon.sh start
for each in /usr/share/tomcat9/bin/*sh ; do bash $each ; done
sudo DEBIAN_FRONTEND=noninteractive apt -y install tomcat9-admin tomcat9-user tomcat9-common apt-utils gcc g++ openjdk-8-jdk  libjson-c-dev cmake libwebsockets-dev build-essential make libavcodec-dev libavutil-dev libavformat-dev libwebsockets-dev git libtelnet-dev libpango1.0-dev libswscale-dev libpulse-dev libvorbis-dev libwebp-dev libssl-dev libssh2-1-dev freerdp2-dev libvncserver-dev libossp-uuid-dev libtool-bin libpng-dev libjpeg-turbo8-dev libcairo2-dev tomcat9 maven build-essential
rm -rf /var/lib/apt/lists/*
GUACVERSION="1.4.0"
SERVER="http://apache.org/dyn/closer.cgi?action=download&filename=guacamole/${GUACVERSION}"
wget -O guacamole-server-${GUACVERSION}.tar.gz ${SERVER}/source/guacamole-server-${GUACVERSION}.tar.gz
tar -xzf guacamole-server-${GUACVERSION}.tar.gz
wget -O guacamole-${GUACVERSION}.war ${SERVER}/binary/guacamole-${GUACVERSION}.war
rm -rf /etc/guacamole*
rm -rf /etc/guacamole/extensions/
mkdir -p /etc/guacamole/lib/
mkdir -p /etc/guacamole/extensions/
sudo mkdir -p /etc/guacamole/{extensions,lib}
mkdir -p /var/guacamole
cd guacamole-server-${GUACVERSION}/
export CFLAGS="-Wno-error"
./configure  --with-init-dir=/etc/init.d
make 
make install 
ldconfig
cd
mv -f guacamole-${GUACVERSION}.war /etc/guacamole/guacamole.war
ln -sf /etc/guacamole/guacamole.war /var/lib/tomcat9/webapps/
ln -s /etc/guacamole/ /usr/share/tomcat9/.guacamole
sudo mkdir /etc/guacamole/{extensions,lib}
sudo echo "GUACAMOLE_HOME=/etc/guacamole" >> /etc/default/tomcat9
wget -O /etc/guacamole/guacamole.properties https://raw.githubusercontent.com/amitstudydude/RDP_Linux/main/guaca  
wget -O  /etc/guacamole/user-mapping.xml https://raw.githubusercontent.com/amitstudydude/RDP_Linux/main/user-mapping.xml 
sed -i 's/localhost/172.17.0.1/g' /etc/guacamole/user-mapping.xml 
wget -O  /etc/guacamole/guacd.conf https://raw.githubusercontent.com/amitstudydude/RDP_Linux/main/guacd.conf
echo -e "Installation Complete\n- Visit: http://localhost:8080/guacamole/\n- Default login (username/password): root/root\n***Be sure to change the password***."
sudo mkdir -p /etc/guacamole/{extensions,lib}
apt-get -y autoclean && apt-get -y autoremove \
&& apt-get -y purge $(dpkg --get-selections | grep deinstall | sed s/deinstall//g) \
&& rm -rf /var/lib/apt/lists/*
mkdir -p /usr/share/tomcat9/logs
for each in /usr/share/tomcat9/bin/*sh ; do bash $each ; done
sudo /usr/share/tomcat9/bin/startup.sh
bash /usr/share/tomcat9/bin/daemon.sh start

service guacd restart
service tomcat9 restart &

#  docker pull ghcr.io/jhajikv-ji/guacamole:latest
#. docker run --net=host -d -p 5040:8080 ghcr.io/jhajikv-ji/guacamole:latest

#
